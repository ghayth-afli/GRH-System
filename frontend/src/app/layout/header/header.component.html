<div class="header">
  <div class="header-content">
    <div class="employee-info">
      <div class="avatar-container">
        <img
          [src]="imageSrc || 'assets/images/nopicture.png'"
          alt="Employee Avatar"
          class="avatar"
        />
      </div>
      <div class="employee-details">
        <div class="name">{{ user.firstName }} {{ user.lastName }}</div>
        <div class="post">
          <div class="job-and-edit-container">
            <div class="job-title">{{ user.jobTitle }}</div>
            <div class="edit-info">
              <button class="edit-info-btn" (click)="openEditModal()">
                Edit Info
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="header-leave-balances" *ngIf="isEmployee()">
      <div class="leave-balance" *ngIf="leaveBalance$ | async as leaveBalance">
        <div class="balance">Remaining balance :</div>
        <div class="days">
          {{ leaveBalance.remainingLeave }}/{{ leaveBalance.totalLeave }}
        </div>
      </div>
    </div>

    <div class="notification-container">
      <div class="notification-icon" (click)="toggleDropdown()">
        <i class="icofont-notification"></i>
        <span
          class="notification-badge"
          *ngIf="(notificationService.unreadCount$ | async) ?? 0 > 0"
        >
          {{ notificationService.unreadCount$ | async }}
        </span>
      </div>
      <div class="notification-dropdown" *ngIf="isDropdownOpen">
        <div class="notification-header">
          <h3>Notifications</h3>
          <button
            class="mark-all-read"
            (click)="notificationService.markAllAsRead().subscribe()"
            *ngIf="(notificationService.unreadCount$ | async) ?? 0 > 0"
          >
            Mark all as read
          </button>
        </div>

        <div
          class="notification-item"
          *ngFor="
            let notification of notificationService.notifications$ | async
          "
          [class.unread]="!notification.read"
          (click)="
            !notification.read &&
              notificationService.markAsRead(notification.id).subscribe()
          "
        >
          <div class="notification-icon-img">
            <i
              class="icofont"
              [ngClass]="{
                'icofont-info-circle': notification.type === 'INFO',
                'icofont-warning-alt': notification.type === 'WARNING',
                'icofont-check-circled': notification.type === 'SUCCESS'
              }"
            ></i>
          </div>
          <div class="notification-content">
            <div class="notification-title">{{ notification.title }}</div>
            <div class="notification-message">{{ notification.message }}</div>
            <div class="notification-time">
              {{ notification.createdAt | date : "shortTime" }}
            </div>
          </div>
          <div class="notification-status">
            <span *ngIf="!notification.read" class="unread-dot"></span>
          </div>
        </div>

        <div
          class="no-notifications"
          *ngIf="(notificationService.notifications$ | async)?.length === 0"
        >
          No new notifications
        </div>
      </div>
    </div>
  </div>
</div>

<div class="form-container">
  <h2 class="form-title">
    {{ isEditMode ? "Edit Training" : "Create Training" }}
  </h2>
  <form #trainingForm="ngForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="title" class="form-label">Title *</label>
      <input
        type="text"
        id="title"
        name="title"
        class="form-input"
        [(ngModel)]="training.title"
        #title="ngModel"
        required
        maxlength="100"
        placeholder="Enter training title"
        aria-label="Training title"
        [attr.aria-describedby]="
          title.invalid && (title.touched || title.dirty)
            ? 'title-errors'
            : null
        "
      />
      @if (title.invalid && (title.touched || title.dirty)) {
      <div class="form-error" id="title-errors">
        @if (title.errors?.['required']) {
        <span id="title-error-required"> Title is required. </span>
        } @if (title.errors?.['maxlength']) {
        <span id="title-error-maxlength">
          Title cannot exceed 100 characters.
        </span>
        }
      </div>
      }
    </div>

    <div class="form-group">
      <label for="description" class="form-label">Description *</label>
      <textarea
        id="description"
        name="description"
        class="form-textarea"
        [(ngModel)]="training.description"
        #description="ngModel"
        required
        maxlength="500"
        placeholder="Enter training description"
        aria-label="Training description"
        [attr.aria-describedby]="
          description.invalid && (description.touched || description.dirty)
            ? 'description-errors'
            : null
        "
      ></textarea>
      @if (description.invalid && (description.touched || description.dirty)) {
      <div class="form-error" id="description-errors">
        @if (description.errors?.['required']) {
        <span id="description-error-required"> Description is required. </span>
        } @if (description.errors?.['maxlength']) {
        <span id="description-error-maxlength">
          Description cannot exceed 500 characters.
        </span>
        }
      </div>
      }
    </div>

    <div class="form-group">
      <label for="startDate" class="form-label">Start Date *</label>
      <input
        id="startDate"
        name="startDate"
        type="date"
        class="form-input"
        [(ngModel)]="training.startDate"
        #startDate="ngModel"
        required
        [min]="today"
        aria-label="Training start date"
        [attr.aria-describedby]="
          startDate.invalid && (startDate.touched || startDate.dirty)
            ? 'startDate-errors'
            : null
        "
      />
      @if (startDate.invalid && (startDate.touched || startDate.dirty)) {
      <div class="form-error" id="startDate-errors">
        @if (startDate.errors?.['required']) {
        <span id="startDate-error-required"> Start Date is required. </span>
        } @if (startDate.errors?.['min']) {
        <span id="startDate-error-min">
          Start Date must be {{ today }} or later.
        </span>
        }
      </div>
      }
    </div>

    <div class="form-group">
      <label for="endDate" class="form-label">End Date *</label>
      <input
        id="endDate"
        name="endDate"
        type="date"
        class="form-input"
        [(ngModel)]="training.endDate"
        #endDate="ngModel"
        required
        [min]="training.startDate || today"
        aria-label="Training end date"
        [attr.aria-describedby]="
          endDate.invalid && (endDate.touched || endDate.dirty)
            ? 'endDate-errors'
            : null
        "
      />
      @if (endDate.invalid && (endDate.touched || endDate.dirty)) {
      <div class="form-error" id="endDate-errors">
        @if (endDate.errors?.['required']) {
        <span id="endDate-error-required"> End Date is required. </span>
        } @if (endDate.errors?.['min']) {
        <span id="endDate-error-min">
          End Date must be on or after Start Date ({{
            training.startDate || today
          }}).
        </span>
        }
      </div>
      }
    </div>

    <div class="form-actions">
      <button
        type="button"
        class="form-btn cancel"
        (click)="onCancel()"
        aria-label="Cancel"
      >
        Cancel
      </button>
      <button
        type="submit"
        class="form-btn save"
        [disabled]="trainingForm.invalid"
        aria-label="Save training"
      >
        @if(isLoading){
        <span class="loader" aria-label="Loading"></span>

        }@else{
        <!-- <i class="form-btn-icon fa-solid fa-save"></i> -->
        @if(isEditMode){
        <i class="form-btn-icon fa-solid fa-pen-to-square"></i>
        Uodate } @else{
        <i class="form-btn-icon fa-solid fa-save"></i>
        Create } }
      </button>
    </div>
  </form>
</div>

<div class="leave-requests-dialog">
  <h2 class="dialog-title">Leave Requests</h2>
  <div class="table-container">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="mat-elevation-z2"
      aria-label="Leave requests table"
    >
      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let element">
          <span
            class="status-tag"
            [ngClass]="{
              'status-pending': element.status === 'PENDING',
              'status-approved': element.status === 'APPROVED',
              'status-rejected': element.status === 'REJECTED',
              'status-cancelled': element.status === 'CANCELLED'
            }"
          >
            {{ element.status }}
          </span>
        </td>
      </ng-container>

      <!-- Start Date Column -->
      <ng-container matColumnDef="startDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Date</th>
        <td mat-cell *matCellDef="let element">
          {{ element.startDate | date : "MMM d, yyyy" }}
        </td>
      </ng-container>

      <!-- End Date Column -->
      <ng-container matColumnDef="endDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>End Date</th>
        <td mat-cell *matCellDef="let element">
          {{ element.endDate | date : "MMM d, yyyy" }}
        </td>
      </ng-container>

      <!-- Leave Type Column -->
      <ng-container matColumnDef="leaveType">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Leave Type</th>
        <td mat-cell *matCellDef="let element">
          <span
            class="leave-type-tag"
            [style.backgroundColor]="element.color"
            >{{ element.leaveType }}</span
          >
        </td>
      </ng-container>

      <!-- Duration Column -->
      <ng-container matColumnDef="duration">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Duration</th>
        <td mat-cell *matCellDef="let element">{{ element.duration }}</td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let element">
          @if( element.status === 'PENDING') {
          <button
            class="action-btn"
            (click)="onCancelLeave(element.id)"
            aria-label="Cancel leave request"
          >
            <i class="fa-solid fa-ban"></i> Cancel
          </button>
          }
        </td>
      </ng-container>

      <!-- Employee Name Column -->
      <ng-container matColumnDef="employeeName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Employee</th>
        <td mat-cell *matCellDef="let element">{{ element.employeeName }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <div class="empty-state" *ngIf="!dataSource.data.length" aria-live="polite">
      No leave requests found.
    </div>
    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
      aria-label="Select page of leave requests"
    ></mat-paginator>
  </div>
  <div class="dialog-actions">
    <button
      class="dialog-btn cancel"
      (click)="dialogRef.close()"
      aria-label="Close dialog"
    >
      <i class="fa-solid fa-times"></i> Close
    </button>
  </div>
</div>

<div class="appointments-page">
  <div class="filter-section">
    <div class="filter-header">
      <h2 class="filter-title">Appointments</h2>
      <div class="search-box">
        <span class="search-icon"><i class="fa-solid fa-search"></i></span>
        <input
          type="text"
          class="search-input"
          placeholder="Search by employee name..."
          [(ngModel)]="employeeNameFilter"
          (ngModelChange)="applyFilters()"
          aria-label="Search appointments by employee name"
        />
      </div>
    </div>
    <div class="filter-controls">
      <div class="filter-group">
        <label class="filter-label">Status:</label>
        <select
          class="filter-select"
          [(ngModel)]="statusFilter"
          (ngModelChange)="applyFilters()"
          aria-label="Filter by status"
        >
          <option value="all">All Statuses</option>
          <option value="PLANIFIE">Planifié</option>
          <option value="CONFIRMED">Confirmed</option>
          <option value="CANCELLED">Cancelled</option>
        </select>
      </div>
    </div>
  </div>

  <div class="no-data" *ngIf="!pagedAppointments.length" aria-live="polite">
    No appointments found.
  </div>
  <div class="appointment-card" *ngFor="let appointment of appointments">
    <div class="appointment-info">
      <h3 class="visit-title">{{ appointment.doctorName }}</h3>
      <div class="appointment-meta">
        <span>ID: {{ appointment.id }}</span>
        <span
          >Time Slot:
          {{ appointment.timeSlot | date : "MMM d, yyyy, h:mm a" }}</span
        >
        <span>Employee: {{ appointment.employeeFullName }}</span>
        <span>Email: {{ appointment.employeeEmail }}</span>
      </div>
    </div>
    <span
      class="appointment-status"
      [ngClass]="appointment.status.toLowerCase()"
    >
      {{ appointment.status }}
    </span>
  </div>

  <div class="pagination">
    <div class="pagination-info">
      Showing
      <b
        >{{ (currentPage - 1) * pageSize + 1 }}-{{
          (currentPage - 1) * pageSize + pagedAppointments.length
        }}</b
      >
      of <b>{{ filteredAppointments.length }}</b> appointments
    </div>
    <div class="pagination-controls">
      <select
        class="page-size-select"
        [(ngModel)]="pageSize"
        (ngModelChange)="updatePagination()"
      >
        <option *ngFor="let size of pageSizeOptions" [value]="size">
          {{ size }} per page
        </option>
      </select>
      <button
        class="pagination-btn"
        [ngClass]="{ disabled: currentPage === 1 }"
        (click)="changePage(currentPage - 1)"
        aria-label="Previous page"
      >
        ◀
      </button>
      <button
        class="pagination-btn"
        *ngFor="let page of getPageNumbers()"
        [ngClass]="{ active: page === currentPage }"
        (click)="changePage(page)"
      >
        {{ page }}
      </button>
      <button
        class="pagination-btn"
        [ngClass]="{ disabled: currentPage === totalPages }"
        (click)="changePage(currentPage + 1)"
        aria-label="Next page"
      >
        ▶
      </button>
    </div>
  </div>
</div>
